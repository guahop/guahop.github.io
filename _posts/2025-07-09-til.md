---
title: "[TIL] 2025.07.09"
date: 2025-07-09
categories: [TIL]
tags: [TIL, 한국정보교육원, 실습, 라우팅, 매트릭, NAT, PAT]
---

# TIL – 2025-07-09
<!-- 오늘 날짜 -->

---

## 📘 Today I Studied
<!-- 오늘 공부한 강의, 실습, 문서 등 -->
- 한국정보교육원 KT클라우드와 NHN Cloud로 완성하는 클라우드 엔지니어 양성 8일차
- 라우팅, DHCP(동적 주소 할당)
- NAT, PAT
- 실습 - 라우팅, NAT, PAT

---

## ✏️ Key Takeaways
<!-- 오늘 배운 주요 개념, 이론, 흐름 등을 자유롭게 정리하세요 -->

### 라우팅과 DHCP
![라우팅](/assets/posts/250709-1.png)
- L3 Switch로 사용한다는 의미는 라우터로 사용한다는 의미이다.
- 상황을 확인하고 라우팅을 안할 애를 선택해야 한다.
- L3 Switch에서 trunking을 하면 물리 IP의 게이트웨이를 설정 못하고 IP를 추가하면 trunking을 못한다.


### 메트릭 (Routing Metric)
![매트릭](/assets/posts/250709-3.png)


```
            [R2]
           /    \
        ①/       \ 
        /          \
     [R1]----------[R3]
      |     ②       |
     [PC_A]       [PC_B]

```


- 여러 경로 중 우선 순위를 지정할 수 있는 것
- 메트릭 값이 낮은 것이 우선 순위가 높다.
- 도착지가 같은 경로가 여러 개 있어도 메트릭 값이 가장 낮은 값만 라우팅 테이블에 올라간다.
- 만약 가장 낮은 메트릭 값이 동일하게 여러 개 있으면 동시에 올라가고 여러 개의 경로를 로드밸런싱으로 사용한다.
- 경로가 여러 개가 있고 다 다르게 메트릭 값을 넣어주면 라우팅 테이블에 올라간 최적의 경로가 다운되었을 때 그 다음으로 낮은 메트릭 값을 가진 경로가 라우팅 테이블에 올라간다.
- 실무에서 메트릭은 양쪽 라우터에 동일하게 넣어줘야 한다. (설계에 맞게 동작하기 위해서)
- 그래서 위의 예제에서 2번 경로의 메트릭을 0, 1번 경로의 메트릭을 1을 넣어주면 라우팅 테이블에는 2번 경로만 올라가고 통신할 때는 라우팅테이블에 올라온 정보로만 통신한다.

#### 라우팅 테이블 상세 정보 보는 법
```S 192.168.20.0/24 [1/0] via 1.1.12.2```

- S(라우팅 프로토콜 종류) 
- 192.168.20.0/24(목적지 네트워크) 
- [1(관리 거리/AD)/0(메트릭)] 
- via 1.1.12.2 (Next Hop)


### NAT
![NAT](/assets/posts/250709-2.png)

```
   [R1] ---- [R2]
    |
   [SW]
  /    \
[PC]   [PC]

```
- 사설 IP와 공인 IP를 라우팅 해주는 기술
- 라우팅과 차이는 라우팅은 공인 IP와 공인 IP를 라우팅하고 NAT는 사설 IP와 공인 IP를 라우팅 한다는 점이다.
- 안쪽(PC)에서는 바깥(R2)로 라우팅이 가능한데 바깥에서 안쪽으로는 라우팅이 안된다. (방화벽 기능)

#### Static NAT
- 직접 사설 IP와 공인 IP를 맵핑 해주는 방법
- 그래서 PC를 껐다가 켜도 공인 IP주소가 고정

##### 방법
1) NAT IP 등록 (NAT 할 사설 IP랑 공인 IP를 등록)   
2) 사설 IP 포트 NAT inside 지정   
3) 바깥으로 나가는 포트 NAT outside로 지정   

```
Router(config)#ip nat inside source static 192.168.10.2 1.1.12.3
Router(config)#int fa0/0
Router(config-if)#ip nat inside
Router(config-if)#int s0/0/0
Router(config-if)#ip nat outside 
```

#### Dynamic NAT
- 알아서 사설 IP를 공인 IP로 맵핑 해주는 방법
- PCf를 껐다가 켜면 맵핑된 공인 IP 주소가 바뀔 수 있다.

##### 방법
1) 사용한 공인 IP pool 생성
2) 사설 IP Pool 생성 (list에 넣음, wildcard mask로 범위 지정)
3) 공인 IP pool이랑 사설 IP Pool이랑 맵핑
4) inside port, outside port 인터페이스에 각각 지정

```
Router(config)#ip nat pool cisco 1.1.12.3 1.1.12.254 netmask 255.255.255.0
Router(config)#access-list 1 permit 192.168.10.0 0.0.0.255 (와일드 카드 마스크 > 사용할 개수 지정)
Router(config)#ip nat inside source list 1 pool cisco

Router(config)#int fa0/0
Router(config-if)#ip nat inside
Router(config-if)#int s0/0/0
Router(config-if)#ip nat outside 
```

### PAT
- 공인 IP 개수가 부족해도 가능하게 해주는 기술
- 1개의 공인 IP로 여러 개의 사설 IP가 사용 가능
- 공인 IP를 하나만 사용해서 IP가 동일하게 부여돼도 포트번호로 구분할 수 있다.
- 방법은 NAT 맵핑할 때 끝에 overload만 추가해주면 된다.

```
Router(config)#ip nat pool cisco 1.1.12.3 1.1.12.3 netmask 255.255.255.0 // 딱 1개만 공인IP로 사용
Router(config)#access-list 1 permit 192.168.10.0 0.0.0.255
Router(config)#ip nat inside source list 1 pool cisco overload

Router(config)#int fa0/0
Router(config-if)#ip nat inside
Router(config-if)#int s0/0/0
Router(config-if)#ip nat outside 

```




--- 
## 🌱 What I Realized
<!-- 오늘 느낀 점, 인사이트, 나만의 정리 -->
- 실습 재밌는데 중간에 라우팅 안되어서 당황했다.
- 라우팅 이해한 것 같은데 한번씩 안되는 이유를 잘 모르겠다.

---

## 👀 Questions & Next Steps
- 실습 이어서 함
<!-- 내일 할 것, 궁금한 점, 더 찾아볼 개념 등 -->
